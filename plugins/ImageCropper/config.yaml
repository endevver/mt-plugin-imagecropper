id: ImageCropper
name: 'Image Cropper'
author_name: 'Endevver, LLC'
author_link: 'http://endevver.com'
plugin_link: 'http://endevver.com/plugins/image-cropper/'
description: "Allows users to define a set of thumbnail prototypes that others can easily generate using a drag-and-drop image cropping tool."
version: 1.1.0
schema_version: 8
blog_config_template: config.tmpl

callbacks:
    MT::App::CMS::init_app: $ImageCropper::ImageCropper::Plugin::init_app
    MT::Asset::Image::post_remove: $ImageCropper::ImageCropper::Plugin::post_remove_asset

upgrade_functions:
    cropper_key_change:
        version_limit: 6
        priority: 1
        updater:
            type: thumbnail_prototype_map
            label: Updating Prototype Map keys...
            code: $ImageCropper::ImageCropper::Upgrade::prototype_map_key
    cropper_abbrev_tables:
        version_limit: 8
        priority: 5
        code: $ImageCropper::ImageCropper::Upgrade::AbbrevTables::run

settings:
    default_quality:
        scope: blog
        default: 60
    annotate_fontfam:
        scope: blog
        default: 'Helvetica'
    annotate_fontsize:
        scope: blog
        default: 10

config_settings:
  DefaultCroppedImageText:
    default: 'Created by "Image Cropper"'

tags:
  block:
    CroppedAsset: $ImageCropper::ImageCropper::Plugin::hdlr_cropped_asset
  function:
    DefaultCroppedImageText: $ImageCropper::ImageCropper::Plugin::hdlr_default_text

object_types:
    thumbnail_prototype: ImageCropper::Prototype
    thumbnail_prototype_map: ImageCropper::PrototypeMap

applications:
  cms:
    menus:
      # MT5 compatibility: add to the Settings menu
      settings:image_cropper:
        label: Thumbnail Prototypes
        mode: list
        args:
            _type: thumbnail_prototype
        order: 500
        view: blog
      # MT4 compatibility: add to the Preferences menu
      prefs:image_cropper:
        label: Thumbnail Prototypes
        mode: list_prototypes
        order: 500
        view: blog
    methods:
      list_prototypes: $ImageCropper::ImageCropper::Plugin::list_prototypes
      edit_prototype: $ImageCropper::ImageCropper::Plugin::edit_prototype
      delete_prototype: $ImageCropper::ImageCropper::Plugin::del_prototype
      save_prototype: $ImageCropper::ImageCropper::Plugin::save_prototype
      manage_thumbnails: $ImageCropper::ImageCropper::Plugin::gen_thumbnails_start
      imagecropper_crop: $ImageCropper::ImageCropper::Plugin::crop
      imagecropper_delete_crop: $ImageCropper::ImageCropper::Plugin::delete_crop
    page_actions:
      asset:
        gen_thumbnails: 
          label: 'Generate Thumbnails'
          order: 100
          mode: manage_thumbnails

listing_screens:
    thumbnail_prototype:
        primary: 'label'
        default_sort_key: 'label'

list_properties:
    thumbnail_prototype: $ImageCropper::ImageCropper::Prototype::list_properties

list_actions:
    thumbnail_prototype:
        delete:
            label: 'Delete'
            order: 200
            mode: delete_prototype
            continue_prompt: 'Are you sure you want to delete the selected prototype(s)?'
            button: 1

content_actions:
    thumbnail_prototype:
        create:
            label: 'Create a new thumbnail prototype'
            order: 100
            dialog: 1
            mode: edit_prototype
            class: 'icon-create'

